<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>The curious case of Simpson‚Äôs Paradox | Breaking the Jargons</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="The curious case of Simpson‚Äôs Paradox" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Statistical tests and analysis can be confounded by a simple misunderstanding of the data" />
<meta property="og:description" content="Statistical tests and analysis can be confounded by a simple misunderstanding of the data" />
<link rel="canonical" href="https://parulnith.github.io/blog/statistics/2021/05/06/The-curious-case-of-Simpson-s-Paradox.html" />
<meta property="og:url" content="https://parulnith.github.io/blog/statistics/2021/05/06/The-curious-case-of-Simpson-s-Paradox.html" />
<meta property="og:site_name" content="Breaking the Jargons" />
<meta property="og:image" content="https://parulnith.github.io/blog/images/2021-05-06-The%20curious%20case%20of%20Simpson%E2%80%99s%20Paradox/0.jpeg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-05-06T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://parulnith.github.io/blog/statistics/2021/05/06/The-curious-case-of-Simpson-s-Paradox.html","@type":"BlogPosting","headline":"The curious case of Simpson‚Äôs Paradox","dateModified":"2021-05-06T00:00:00-05:00","datePublished":"2021-05-06T00:00:00-05:00","image":"https://parulnith.github.io/blog/images/2021-05-06-The%20curious%20case%20of%20Simpson%E2%80%99s%20Paradox/0.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"https://parulnith.github.io/blog/statistics/2021/05/06/The-curious-case-of-Simpson-s-Paradox.html"},"description":"Statistical tests and analysis can be confounded by a simple misunderstanding of the data","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://parulnith.github.io/blog/feed.xml" title="Breaking the Jargons" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" /><script src="https://hypothes.is/embed.js" async></script>

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Breaking the Jargons</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Categories</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">The curious case of Simpson‚Äôs Paradox</h1><p class="page-description">Statistical tests and analysis can be confounded by a simple misunderstanding of the data</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-05-06T00:00:00-05:00" itemprop="datePublished">
        May 6, 2021
      </time>
       ‚Ä¢ <span class="read-time" title="Estimated read time">
    
    
      5 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#Statistics">Statistics</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><em>This article was originally published <a href="https://towardsdatascience.com/the-curious-case-of-simpsons-paradox-6f178548d7e8?sk=ef5825185b5781525f0de82c9b23bf70">here</a></em></p>

<p><img src="https://miro.medium.com/max/10032/0*6yc_IK25IZsQ_gt9" alt="Alt Text" />
<sub>Photo by <a href="https://unsplash.com/@bdchu614?utm_source=medium&amp;utm_medium=referral">Brendan Church</a> on <a href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral">Unsplash</a></sub></p>

<blockquote>
  <p>Statistics rarely offers a single ‚Äúright‚Äùway of doing anything ‚Äî <a href="https://en.wikipedia.org/wiki/Charles_Wheelan">Charles Wheelan</a> in Naked Statistics</p>
</blockquote>

<p>In 1996, <a href="https://www.researchgate.net/publication/254331089_Ignoring_a_Covariate_An_Example_of_Simpson's_Paradox">Appleton, French, and Vanderpump</a>* conducted an experiment to study the effect of smoking on a sample of people. The study was conducted over twenty years and included 1314 English women. Contrary to the common belief, this study showed that <strong>Smokers tend to live longer than</strong> non-smokers. Even though I am not an expert on the effects of smoking on human health, this finding is disturbing. The graph below shows that smokers had a mortality rate of 23%, while for non-smokers, it was around 31%.</p>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*iDyNS-0t3aqoMWNOY5ySfQ.png" alt="Alt Text" /></p>

<p><sub>The mortality rate of smokers vs. non-smokers</sub></p>

<p>Now, here‚Äôs where the things get interesting. On breaking the same data by age group, we get an entirely different picture. The results show that in most age groups, smokers have a high mortality rate compared to non-smokers.</p>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*a_7T9kLqig2uLxiikgnetw.png" alt="Alt Text" />
<sub>Results of the study broken down by age group</sub></p>

<h3 id="so-why-the-confusion">So why the confusion?ü§î</h3>

<p>Well, the phenomenon that we just saw above is a classic case of <strong>Simpson‚Äôs paradox</strong>, which from time to makes way into a lot of data-driven analysis. In this article, we‚Äôll look a little deeper into it and understand how to avoid fallacies like these in our analysis.</p>

<hr />

<h2 id="simpsons-paradox-things-arent-always-as-they-seem">Simpson‚Äôs Paradox: Things aren‚Äôt always as they seem</h2>

<p><img src="https://cdn-images-1.medium.com/max/3840/1*4VUfxWFvYDhgg7d80vnMuA.jpeg" alt="Alt Text" />
<sub>Image by <a href="https://pixabay.com/users/ctribeiro-680997/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1708964">Carlos Ribeiro</a> from <a href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1708964">Pixabay</a></sub></p>

<p>As per Wikipedia, <strong>Simpson‚Äôs paradox</strong> also called the <strong>Yule-Simpson effect</strong>, can be defined as follows:*</p>
<blockquote>
  <p><a href="https://en.wikipedia.org/wiki/Simpson%27s_paradox">Simpson‚Äôs Paradox is a phenomenon in probability and statistics, in which a trend appears in several different groups of data but disappears or reverses when these groups are combined.</a></p>
</blockquote>

<p>In other words, the same data set can appear to show opposite trends depending on how it‚Äôs grouped. This is exactly what we saw in the smokers vs. non-smokers mortality rate example. When grouped age-wise, the data shows that non-smokers tend to live longer. But when we see an overall picture, smokers tend to live longer. So what is exactly happening here? Why are there different interpretations of the same data, and what is evading our eye in the first case? Well, The culprit, in this case, is called the <strong>Lurking variable ‚Äî</strong> a conditional variable <em>**</em>that can affect our conclusions about the relationship between two variables ‚Äî smoking and mortality in our case.</p>

<hr />

<h2 id="identifying-the-lurking-variable-">Identifying the Lurking variable üîç</h2>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*vkiDwWnsTb6BxaJU1XPFvg.png" alt="Alt Text" /></p>

<p>Lurking means to be present in a latent or barely discernible state, although still having an effect. In the same way, a lurking variable is a variable that isn‚Äôt included in the analysis but, if included, can considerably change the outcome of the analysis.</p>

<p>The <strong>age groups</strong> are the lurking variable in the example discussed. When the data were grouped by age, we saw that the non-smokers were significantly older on average, and thus, more likely to die during the trial period, precisely because they were living longer in general.</p>

<hr />

<h2 id="try-it-out-for-yourself-">Try it out for yourself. üíª</h2>

<p>Here is another example where the effect of Simpson‚Äôs Paradox is easily visible. We all are aware of the <a href="https://allisonhorst.github.io/palmerpenguins/articles/intro.html"><strong>Palmer Penguins</strong></a>üêß <a href="https://allisonhorst.github.io/palmerpenguins/articles/intro.html">dataset</a> ‚Äî the drop-in replacement for the famous iris dataset. The dataset consists of details about three species of penguins, including their culmen length and depth, their flipper length, body mass, and sex. The culmen is essentially the upper ridge of a penguin‚Äôs beak, while their wings are called flippers. The dataset is <a href="https://www.kaggle.com/parulpandey/palmer-archipelago-antarctica-penguin-data?select=penguins_size.csv">available for download</a> on Kaggle.</p>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*gIOJSSoVH7i0GyOAtV0ZfA.jpeg" alt="Alt Text" /> 
<sub><a href="https://www.freepik.com/vectors/nature">Nature vector created by brgfx ‚Äî www.freepik.com</a> | Attribution 1.0 Generic (<a href="https://creativecommons.org/licenses/by/1.0/">CC BY 1.0</a>)</sub></p>

<hr />

<h3 id="importing-the-necessary-libraries-and-the-dataset">Importing the necessary libraries and the dataset</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import pandas as pd
import seaborn as sns
from scipy import stats
import matplotlib.pyplot as plt
%matplotlib inline

#plt.rcParams['figure.figsize'] = 12, 10
plt.style.use("fivethirtyeight")# for pretty graphs

df  = pd.read_csv('[penguins_size.csv'](https://raw.githubusercontent.com/parulnith/Website-articles-datasets/master/penguins_size.csv'))
df.head()')
df.info()
</code></pre></div></div>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*0Wg8r9copQYj5EWpG_gdnQ.png" alt="" /></p>

<p>There are few missing values in the dataset. Let‚Äôs get rid of those.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>df = df.dropna()
</code></pre></div></div>

<p>Let‚Äôs now visualize the relationship between the <strong>culmen length of the penguins vs. their culmen depth</strong>. We‚Äôll use seaborn‚Äôs lmplot method (where ‚Äúlm‚Äù stands for ‚Äúlinear model‚Äù)for the same.</p>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*pI8zh6NZE_JV262dcpv-iA.png" alt="Alt Text" /></p>

<p>Here we see a negative association between culmen length and culmen depth for the data set. The results above demonstrate that the longer the culmen or the beak, the less dense it is. We have also calculated the correlation coefficient between the two columns to view the negative association using the <a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient#:~:text=In%20statistics%2C%20the%20Pearson%20correlation,between%20two%20sets%20of%20data.">Pearson correlation coefficient</a>(PCC), referred to as <strong>Pearson‚Äôs r</strong>. The PCC is a number between -1 and 1 and measures the linear correlation between two data sets. The Scipy library provides a method called pearsonr() for the same.</p>

<h3 id="drilling-down-at-species-level">Drilling down at Species level</h3>

<p>When you drill down further and group the data species-wise, the findings reverse. The ‚Äòhue‚Äô parameter determines which column in the data frame should be used for color encoding.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sns.lmplot(x = 'culmen_length_mm',y = 'culmen_depth_mm', data = df, hue = 'species')
</code></pre></div></div>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*7y1G5oTdu1Lc9tdaSNwCng.png" alt="Alt Text" /></p>

<p>Voila! What we have is a classic example of Simpson‚Äôs effect. While the culmen‚Äôs length and depth were negatively associated on a group level, the species level data exhibits an opposite association. Thus the type of <strong>species</strong> is a <strong>lurking variable</strong> here. We can also see the person‚Äôs coefficient for each of the species using the code below:</p>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*EOm4SCGWijobj30NoQdZlQ.png" alt="Alt Text" /></p>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*5MiFXw4wem7giROBCQqeVA.png" alt="Alt Text" /></p>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*bK7w4jPGD8o6JxV3qXR4qA.png" alt="Alt Text" /></p>
<blockquote>
  <p><strong>Here is the <a href="https://nbviewer.jupyter.org/github/parulnith/Data-Science-Articles/tree/main/The%20curious%20case%20of%20Simpson%27s%20Paradox/">nbviewer link</a> to the notebook incase you want to follow along.</strong></p>
</blockquote>

<hr />

<h2 id="tools-to-discover-simpsons-effect-">Tools to discover Simpson‚Äôs effect üõ†</h2>

<p>Detecting Simpson‚Äôs effect in a dataset can be tricky and requires some careful observation and analysis. However, since this issue pops up from time to time in the statistical world, few tools have been created to help us deal with it. A paper titled ‚Äú<a href="https://arxiv.org/abs/1805.03094">Using Simpson‚Äôs Paradox to Discover Interesting Patterns in Behavioral Data</a>.‚Äù was released in 2018, highlighting a data-driven discovery method that leverages Simpson‚Äôs paradox to uncover interesting patterns in behavioral data. *The method systematically disaggregates data to identify subgroups within a population whose behavior deviates significantly from the rest of the population. *It is a great read and also has the link to the code.</p>

<hr />

<h2 id="conclusion">Conclusion</h2>

<p>Data comes with a lot of power and can be easily manipulated to suit our needs and objectives. There are multiple ways of aggregating and grouping data. Depending upon how it is grouped, the data may offer confounding results. It is up to us to carefully assess all the details using the statistical tools and look for lurking variables that might affect our decisions and outcomes.</p>


  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="parulnith/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/statistics/2021/05/06/The-curious-case-of-Simpson-s-Paradox.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Posts on Machine Learning &amp; Data Science</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/parulnith" title="parulnith"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/parulpandeyindia" title="parulpandeyindia"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a rel="me" href="https://twitter.com/pandeyparul" title="pandeyparul"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
